# Overview

Source code for the Hansa Compiler.

## Prerequisites:
Python (supported version: 3.10)


## Using Docker to run the compiler:
There is a docker image with all the required dependencies installed. You can
run the compiler with a simple make command:

```
make compiler \
    INPUT_T_CIRCUIT="$(pwd)/data/inputs/transpiled_circuits/Compiled_sk_mol_HH_recdep_2_dep_4_20230224-04-07.txt" \
    OUTPUT_DIR="$(pwd)/data/outputs" \
    OUTPUT_REPORT_FILENAME="my_report.txt" \
    INPUT_LAYOUT="$(pwd)/data/inputs/layout_files/sc_block_data_64_depot_2_corner.pkl" \
    INPUT_HLASCHEDULER_PARAMS="$(pwd)/data/inputs/hla_scheduler_params/params.json" \
    DUAL_MODE="True"
```
This should produce a `my_report.txt` in your `OUTPUT_DIR` folder.
- Important Note: File paths should be absolute to ensure proper volume mounting

List of Command Arguments for the Compiler:

| Parameter                              | Type    | Description                                                                                                                              |
|----------------------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------|
| INPUT_T_CIRCUIT                        | String  | Absolute path to the transpiled circuit file.                                                                                             |
| OUTPUT_DIR                        | String  | Absolute file directory to where the output report is located.                                                                                      |
| OUTPUT_REPORT_FILENAME (optional)              | String  | The name of the output report generated |
| INPUT_LAYOUT (optional)              | String  | The path to a layout map representing a quantum chip architecture that uses a topological correction scheme in .pkl format. If no layout map is provided, Hansa generates a layout map that minimizes the quantum resources needed for achieving the target error approximation bound. |
| INPUT_HLASCHEDULER_PARAMS (optional)               | String  | The path to a json file specifying the set of parameters used in the HLASCHEDULER. If not provided, default config will be used. Details can be found in the next section. |
| GENERATE_HLA_SCHEDULE (optional) | Bool    | True if you would like to have the schedules generated for HLASCHEDULER. The default value is false.                                   |
| DUAL_MODE (optional)    | Bool    | Users have the option to run both the scheduler and HLAScheduler sequentially when they provide their own layout. This enables them to compare the results generated by each scheduler. By default, this option is set to false, indicating that only the scheduler will be run.                                          |

List of HLASCHEDULER parameters that can be provided in a JSON file:

| Parameters                | Description                                                             |
|---------------------------|-------------------------------------------------------------------------|
| nb_fac                    | Todo. Default: 8.                                                       |
| depot_entry               | Todo. Default: 2.                                                       |
| depot_exit                | Todo. Default: 2.                                                       |
| depot_capacity            | Todo. Default: 16.                                                      |
| distillation_protocol     | Todo. Default: "20:4".                                                  |
| physical_qubit_error_rate | Todo. Default: 0.001.                                                   |

# Getting started Local Development:
Running the scheduler with a transpiled circuit file.

1. Once you have cloned the repo, install dependencies by navigating into the top-level directory of the repository and running

```
pip install -e .
```

2. Running the main compiler code with the file path
```
python3 src/main.py \
    --input_t_circuit "PATH/TO/CIRCUIT" \
    --output_dir "DIR/TO/OUTPUT" \
    --output_report_filename "REPORT_FILENAME" \
    --input_hla_scheduler_params "PATH/TO/LAYOUT/PARMS"
```
